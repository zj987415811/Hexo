---
title: 分布式学习之秒杀系统架构
date: 2018-08-09 15:07:08
tags: 秒杀
---
##秒杀系统架构##
1.秒杀系统特点
	
	- 瞬时并发量大，大量用户会在同一时间进行抢购，网站瞬时流量访问激增；
	- 库存少：访问请求数量远远大于库存数量，只有少部分用户能够秒杀成功。
	- 业务流程简单：业务流程比较简单，下单减库存。
2.技术难点
	
	- 对现有业务的冲击
	- 高并发应用负载高
	- 突然增加网络与服务带宽
	- 直接下但
	- 控制商品页面购买按钮高亮
	- 下单前置检查
3.架构思想
	
	- 限流：限制大部分用户流量，只有少部分用户能够进入后端服务器
	- 削峰：秒杀开始一瞬间，会有大量用户冲击进来，会有一个瞬时流量峰值。通过缓存或者MQ中间件来解决。
	- 异步处理：异步处理模式可以极大提高系统并发量
	- 内存缓存：最大瓶颈是数据库的读写，下单扣减库存，属于磁盘IO,性能低，把部分数据业务逻辑转移到内存缓存，效率极大提升。
4.优化
	

	客户端优化
	- 秒杀页面优化：页面整体静态化，将静态化页面发送到CDN边缘节点上，压力分散的作用。
	- 防止提前下单：在静态页面加入一个JS,这个js文件包含活动是否开启的标志以及开始时动态下单页面的url参数，同时这个js不会被cdn缓存，会一直请求后端服务。并且很小，活动快要开始时，通过后台接口修改这个js使之生效。
	api接入层优化
	- 限制用户维度访问频率
	- 限制商品维度访问频率
	soa服务器层优化
	-后端流量控制，通过消息队列，异步处理，提高并发等方式解决，对于超过系统水位线的请求，使用fail-fast原则拒绝掉。
	