---
title: MySQL技术内幕读书笔记
date: 2018-08-06 14:50:15
tags: MySQL
---

第一章：

1.连接MySQL:一个进程和MySQL数据库实例进行通信。实质上是进程通信。
2.进程通信方式：管道，命名管道，命名字，tcpip套接字，unix套接字。

第二章：

1.InnoDB体系架构
	1)后台线程
	2)内存
		i.缓冲池：索引页，数据页，undo页，插入缓冲，自适应哈希索引，InnoDB的锁信息，数据字典信息
		ii.缓冲池的管理：堆的方式
			i)LRU算法
			ii)InnoDB缓冲区管理优化：使用LRU算法+midPoint位置，在midPoint之前的为new列表，之后为old列表
				原因：若直接读取到的页放入LRU的首部，那么某些SQL操作可能会使缓冲池中的页被刷新出，从而影响缓冲池的效率，如索引或者数据的扫描操作。此类操作需要访问表中的许多页，而这些页仅仅实在这次查询中使用，并不是活跃数据。如果放入首页可能会使某些热点数据页从LRU列表移除，而下一次需要读取该页时,InnoDB存储需要访问磁盘。
				解决方法：加入参数来管理LRU，用于表示页读取到mid位置后需要等待多久才会被加入LRU列表的热端。
		iii.重做日志缓冲：首先将日志信息先放入这个缓冲区，然后按一定频率将其刷新到重做日志中，
	
	3)Checkpoint技术
		i.当事务提交时，先重做日志，再修改页
		ii.使用场景：数据宕机恢复，缓冲池可以缓存数据库中所有数据，重做日志无限增大，条件无法保证，并且回复需要时间。
		iii.使用Checkpoint可以解决：
			i)缩短数据库恢复时间；
			ii)缓冲池不够用时；
			iii)重做日志不可用，刷新脏页
	4)Master Thread工作方式

第四章 表

	4.1 索引组织表	
	   i.没有指定主键：判断表中是否有非空的唯一索引，有就为主键；不符合自动创建一个6字节大小的指针，多个非空，选第一个。
	
	4.2 InnoDB逻辑存储结构
		
		i.所有数据都被逻辑地放在一个空间中，称为表空间。表空间由段，区，页组成。
		ii.行数据溢出:
		
	4.6 约束
	  i.完整性约束：保证表中有一个主键。定义primary key 或者unique key约束，触发器
	  ii.域完整性
	  iii.参照完整性：
	  iv.触发器约束：如负数

	  
	4.7 视图：安全作用
	
第五章 索引和算法
	
	1.概述
		i.B+树索引
			i)B+树的插入操作
			ii)B+树的删除操作
			
			iii)聚集索引：逻辑上连续，实际不连续。
			iv)辅助索引：
		ii.全文索引
		iii.哈希索引